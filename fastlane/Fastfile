import("keys")

add_extra_platforms(
  platforms: [:tvos]
)
default_platform(:ios)

update_app_identifier(
  xcodeproj: "Provenance.xcodeproj", # Optional path to xcodeproj, will use the first .xcodeproj if not set
  plist_path: "Provenance/Info.plist", # Path to info plist file, relative to xcodeproj
  app_identifier: "info.descom-online.Provenance" # The App Identifier
)

platform :ios do
  lane :beta do
    get_certificates(
      development: true,
      username: ENV["APPLE_ID"],
      team_id: ENV["DEV_TEAM_ID"]
    )           # invokes cert
    get_provisioning_profile(force: true)   # invokes sigh
    build_app(scheme: "Provenance")
    upload_to_testflight
    slack(message: "Successfully distributed a new beta iOS build")
  end
end

platform :tvos do
  lane :beta do
    get_certificates(
      development: true,
      username: ENV["APPLE_ID"],
      team_id: ENV["DEV_TEAM_ID"]
    )           # invokes cert
    get_provisioning_profile(force: true)   # invokes sigh
    build_app(scheme: "ProvenanceTV")
    upload_to_testflight
    slack(message: "Successfully distributed a new beta tvOS build")
  end
end
